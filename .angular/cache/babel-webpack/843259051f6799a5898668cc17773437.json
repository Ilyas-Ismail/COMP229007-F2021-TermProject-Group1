{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/survey.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/radio\";\n\nfunction DetailsComponent_div_0_div_9_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵelementStart(2, \"mat-radio-button\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const choice_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"value\", choice_r5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(choice_r5);\n  }\n}\n\nfunction DetailsComponent_div_0_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelementStart(1, \"h5\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementStart(4, \"mat-radio-group\", 9);\n    i0.ɵɵtemplate(5, DetailsComponent_div_0_div_9_div_5_Template, 5, 2, \"div\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const choices_r2 = ctx.$implicit;\n    const i_r3 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Q: \", ctx_r1.survey.Questions[i_r3], \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"name\", i_r3);\n    i0.ɵɵproperty(\"formControl\", ctx_r1.getChoice(i_r3).get(\"choice\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", choices_r2);\n  }\n}\n\nfunction DetailsComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelementStart(1, \"div\", 2);\n    i0.ɵɵelementStart(2, \"div\", 3);\n    i0.ɵɵelementStart(3, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function DetailsComponent_div_0_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.onSubmit();\n    });\n    i0.ɵɵelementStart(4, \"div\", 5);\n    i0.ɵɵelementStart(5, \"h2\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"br\");\n    i0.ɵɵelement(8, \"br\");\n    i0.ɵɵtemplate(9, DetailsComponent_div_0_div_9_Template, 7, 4, \"div\", 6);\n    i0.ɵɵelementStart(10, \"button\", 7);\n    i0.ɵɵtext(11, \" Submit \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \" \\u00A0 \");\n    i0.ɵɵelementStart(13, \"a\", 8);\n    i0.ɵɵtext(14, \" Back to List \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"Survey Title: \", ctx_r0.survey.Title, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.survey.Choices);\n  }\n}\n\nexport let DetailsComponent = /*#__PURE__*/(() => {\n  class DetailsComponent {\n    constructor(surveyService, route, router, formBuilder) {\n      this.surveyService = surveyService;\n      this.route = route;\n      this.router = router;\n      this.formBuilder = formBuilder;\n      this.surveyResponse = {\n        surveyID: '',\n        choices: []\n      };\n      this.detailForm = this.formBuilder.array([]);\n    }\n\n    ngOnInit() {\n      this.getSurvey(this.route.snapshot.params[\"id\"]);\n    }\n\n    getSurvey(id) {\n      this.surveyService.get(id).subscribe({\n        next: data => {\n          this.survey = data;\n          console.log(this.survey);\n          this.initForm();\n        },\n        error: e => console.error(e)\n      });\n    }\n\n    initForm() {\n      for (let i = 0; i < this.survey.Questions.length; i++) {\n        this.detailForm.push(this.newChoice());\n      }\n    }\n\n    newChoice() {\n      return this.formBuilder.group({\n        choice: ['']\n      });\n    }\n\n    getChoice(index) {\n      return this.detailForm.at(index);\n    }\n\n    onSubmit() {\n      this.surveyResponse.surveyID = this.survey._id;\n      this.detailForm.value.forEach(e => {\n        this.surveyResponse.choices.push(e.choice);\n      }); // save user response into the database\n\n      this.surveyService.create(this.surveyResponse, 'addres').subscribe({\n        next: res => {\n          // res is a stored user response in the database\n          console.log(res);\n          this.router.navigate([`surveys/list`]);\n        },\n        error: e => console.error(e)\n      });\n    }\n\n  }\n\n  DetailsComponent.ɵfac = function DetailsComponent_Factory(t) {\n    return new (t || DetailsComponent)(i0.ɵɵdirectiveInject(i1.SurveyService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n\n  DetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DetailsComponent,\n    selectors: [[\"app-details\"]],\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"container\", 4, \"ngIf\"], [1, \"container\"], [1, \"row\"], [1, \"offset-md-3\", \"col-md-6\"], [3, \"ngSubmit\"], [1, \"form-group\"], [\"class\", \"form-group\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-primary\"], [\"routerLink\", \"/surveys/list\", 1, \"btn\", \"btn-warning\"], [\"labelPosition\", \"after\", \"required\", \"\", 3, \"name\", \"formControl\"], [\"class\", \"container\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"]],\n    template: function DetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, DetailsComponent_div_0_Template, 15, 2, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.survey !== undefined);\n      }\n    },\n    directives: [i4.NgIf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i4.NgForOf, i2.RouterLinkWithHref, i5.MatRadioGroup, i3.RequiredValidator, i3.NgControlStatus, i3.FormControlDirective, i5.MatRadioButton],\n    styles: [\"\"]\n  });\n  return DetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}